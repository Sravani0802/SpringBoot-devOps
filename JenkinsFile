pipeline{
  agent any
  environment {
        KUBECONFIG = "C:/Users/SRAVANI/.kube/config"
  }
  stages {

    stage('Webhook Test') {
      steps {
        echo "GitHub webhook triggered successfully Now!"
      }
    }

    stage('Checkout SpringBoot-devOps') {
      steps {
          git branch: 'main', url: 'https://github.com/Sravani0802/SpringBoot-devOps.git', credentialsId: 'github-creds'
      }
    }

    stage('Clone SpringBoot-devOps') {
      steps {
          git branch: 'main', url: 'https://github.com/Sravani0802/SpringBoot-devOps.git', credentialsId: 'github-creds'
      }
    }

    
    stage('Checkout') {
    steps {
        checkout scm
    }
}

    stage('Build Maven') {
        steps {
            sh 'mvn clean package -DskipTests'
        }
    }

    stage('Build Docker Image') {
      steps {
        bat 'docker build -t java-application:latest .'
      }
    }

    stage('Deploy to Kubernetes') {
      steps {
        bat 'kubectl apply -f k8s/'
      }
    }
  }
}

